\documentclass[11pt,a4paper]{report}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%%    Header file for the Phi-S-X Series                           %%
%%                                                                 %%
%%    german version header_gm.tex is derived from header.tex      %%
%%    by uncommenting the line ``\setboolean{german}{true}'' below %%
%%                                                                 %%
%%    Never edit the german version! all changes must be done      %%
%%    in the english version header.tex                            %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{../header}
\hypersetup{pdftitle=paw_brillouin}
\begin{document}
\begin{titlepage}
\begin{center}
\vspace*{3.5cm}
{\huge \textbf{The DMFT object of the CP-PAW code}}\\
\vspace{0.5cm}
{\large Peter E. Bl\"ochl}
\vspace{0.5cm} 
\end{center}

\vfill
\begin{center}
Copyright Peter E. Bl\"ochl; Sept.2, 2013-\today\\
{\small
Institute of Theoretical Physics;
Clausthal University of Technology;\\ 
D-38678 Clausthal Zellerfeld; Germany;\\
http://www.pt.tu-clausthal.de/atp/}
\end{center}
\end{titlepage}
\noindent            
\tableofcontents
%====================================================================
\chapter{BRILLOUIN object}
%====================================================================
%====================================================================
\section{Purpose and theoretical background}
%====================================================================
The purpose of this object is to perform integrations of matrix
elements over the occupied part of Brillouin zone.
\begin{eqnarray}
\langle A\rangle=\sum_n \frac{1}{V_G}\int d^3k\;
A_n(\vec{k})\theta(\epsilon_n(\vec{k})-\mu)
\end{eqnarray}
where the matrix of the one-particle operator $\hat{A}$ elements are
\begin{eqnarray}
A_n(\vec{k})=\langle\psi_n(\vec{k})|\hat{A}|\psi_n(\vec{k})\rangle
\end{eqnarray}
and $\epsilon_n(\vec{k})$ are the one-particle energies, the
eigenvalues of the Hamiltonian.

In the linear tetrahedron method\cite{jepsen71_ssc9_1763,
  lehmann72_pssb54_469, bloechl94_prb49_16223}, the function values
are evaluated at a set of discrete k-points $\vec{k}_j$ and energy
levels and matrix elements are linarly interpolated within tetrahedra
filling the space between the grid points.

The BRILLOUIN object selects the grid points and reduces them on the
basis of point groups symemtry operations of the crystal.

If the integral is performed as linear interpolation between grid
points, it can be written in the simple form
\begin{eqnarray}
\langle A\rangle=\sum_n\sum_{j} w_n(\vec{k}_j) A_n(\vec{k}_j)
\end{eqnarray}
where the integration weights are independent of the type if matrix
element to be integrated.\cite{bloechl94_prb49_16223} They are
evaluated using the tetrahedron method.

The integration weights include a quadratic correction, which improves
the integrals substantially beyond the purely linear
approximation.\cite{bloechl94_prb49_16223}

%====================================================================
\subsection{Symmetry operations}
%====================================================================
The symmetry operations can be found in the book by Bradley and
Cracknell\cite{bradley72_book}, which lists in table~3.4
\textit{``Results of operatoes on the reciprocal lattice vectors''}
the point group operations in terms of reciprocal lattice vectors of
all the space-point groups of crystals. Note that the operations in
terms of real space lattice vectors differ from those in reciprocal
lattice vectors.

It is very important that the real-space lattice vectors are chosen
exactly in the convention of table~3.1 \textit{``The 14 Bravais
  lattices''} of Bradley Cracknell. There are different possible
choices, but only the one given in the book is compatible with teh
transformations in Table 3.4.

The transformations are converted into matrices as follows: Let us
take the operation $C^+_{32}$ for the face-centered cubic lattice
$\Gamma^f_c$:
\begin{center}
\begin{tabular}{|l|c|c|c|}
\hline
&\multicolumn{3}{|c|}{$\Gamma^f_c$}\\
\hline
$C^+_{32}$ & $-\vec{g}_1-\vec{g}_2-\vec{g}_3$ & $\vec{g}_1$ & $\vec{g}_3$\\
\hline
\end{tabular}
\end{center}
The resulting matrix is
\begin{eqnarray}
\mat{O}=
\left(\begin{array}{ccc}
-1 & 1 & 0 \\
-1 & 0 & 0 \\
-1 & 0 & 1\\
\end{array}\right)
\end{eqnarray}
The first lattice vector $\vec{g}_1$ has the form $\vec{i}=(1,0,0)$ in
relative coordinates. It is transformed into $\vec{i'}=\mat{O}\vec{i}
=(-1,-1,-1)$, which is $-\vec{g}_1-\vec{g}_2-\vec{g}_3$.

It is only necessary to provide the generators of the point group.
The generators are a minimum set of operations from which all point
group operations are be obtained as products of these generators.



%================================================================
\section{Code structure}
%================================================================
%================================================================
\section{Brillouin\_module}
%================================================================
The object has an internal memory, which is kept in the Brillouin
module in the data structure \verb|THIS|.
\begin{verbatim}
TYPE THIS_TYPE
  INTEGER(4)             :: NKP       ! #(IRREDUCIBLE KPOINTS)
  INTEGER(4)             :: NTET      ! #(IRREDUCIBLE TETRAHEDRA)
  REAL(8)                :: VOL       ! 1/#(GENERAL TETRAHEDRA)
  REAL(8)                :: RBAS(3,3) ! REAL SPACE LATTICE VECTORS
  integer(4)             :: NKDIV(3)
  integer(4)             :: ishift(3)
  REAL(8)       ,POINTER :: XK(:,:)   !(3,NKP) IRR. K-POINTS IN RELATIVE COORDINATES
  INTEGER(4)    ,POINTER :: IKP(:,:)  !(4,NTET) TETRAHEDRON CORNERS
  INTEGER(4)    ,POINTER :: MULT(:)   !(NTET) MULTIPLICITY OF THE TETRAHEDRON
  INTEGER(4)    ,POINTER :: irrkp(:)  !(nmshp) pointer to irr. k-point
END TYPE THIS_TYPE
\end{verbatim}


%================================================================
\section{Brillouin\_msh}
%================================================================
\begin{itemize}
\item RBAS real-space lattice vectors in kartesian coordinates
\item NGKP Target value of the number of general
  k-points on the interpolation grid
\item NSYM number of generators for the point group operations 
\item IARB
\item TSHIFT
\end{itemize}

First, the k-point grid is defined by determining the division of the
lattice vectors $N(3)$ in \verb|brillouin_basdiv|. The value
$NMSHPNT=(N(1)+1)*(N(2)+1)*(N(3)+1)$ is returned. The grid divisions
are placed onto \verb|this%nkdiv|

In \verb|brillouin_reduz| the k-points are mapped onto each other
using the point group operations
\begin{eqnarray}
\vec{k}_{i_1,i_2,i_3}=\sum_{j=1}^3 \vec{g}_{j}\frac{i_{j}+\frac{1}{2}\tau_j}{n_{j}}
\nonumber
\vec{i}'=\mat{O}\vec{i}
\end{eqnarray}
In this way a mapping 
between k-points is established. For two symetry
related k-points the mapping always goes to the k-point with the lower
value according to some unique numbering scheme.

In \verb|brillouin_zuord| this mapping is used to determine the
irreducible k-points on the grid. The irreducible k-points are the
those that are mapped under the mapping \verb|NUM| onto themselfes
Those k-points will be calculated in relative coordinates as $XK$ an
the mapping $NUM$ will be modified so that the general k-points point
onto the irreducible k-points in their own arrangement.

The tetrahedra are calculated and mappend onto irreducible ones.

\bibliographystyle{unsrtnat}
\bibliography{../all}
\end{document}  
